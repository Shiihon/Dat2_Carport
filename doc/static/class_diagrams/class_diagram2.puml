@startuml
'https://plantuml.com/class-diagram
!pragma layout smetana
set separator none

class Main {
    + {static} void main(String[] args)
}

class AccountController {
    + {static} void addRoutes(Javalin app, ConnectionPool connectionPool)
    - {static} void createAccount(Context ctx, ConnectionPool connectionPool)
    - {static} void login(Context ctx, ConnectionPool connectionPool)
    - {static} void logout(Context ctx)
}

class SalesController {
    + {static} void addRoutes(Javalin app, ConnectionPool connectionPool)
    - {static} void viewRequests(Context ctx, ConnectionPool connectionPool)
    - {static} void approveReview(Context ctx, ConnectionPool connectionPool)
    - {static} void updatePrice(Context ctx, ConnectionPool connectionPool)
    - {static} void viewCostumersOrders(Context ctx, ConnectionPool connectionPool)
    - {static} void viewCarportSchematic(Context ctx)
    - {static} void viewOrderDetails(Context ctx, ConnectionPool connectionPool)
}

class OrderController {
    + {static} void addRoutes(Javalin app, ConnectionPool connectionPool)
    - {static} void continueRequest(Context ctx, ConnectionPool connectionPool)
    - {static} void sendOrderRequest(Context ctx, ConnectionPool connectionPool)
    - {static} double calculateOrderBillPrice(List<OrderBillItem> orderBillItemList)
    - {static} void viewMyOrders(Context ctx, ConnectionPool connectionPool)
    - {static} void payOrder(Context ctx, ConnectionPool connectionPool)
    - {static} void viewInvoice(Context ctx, ConnectionPool connectionPool)
    - {static} void cancelOrder(Context ctx, ConnectionPool connectionPool)
    - {static} void viewCarportSchematic(Context ctx)
}

class WarehouseController {
    + {static} void addRoutes(Javalin app, ConnectionPool connectionPool)
    - {static} void viewWarehouse(Context ctx, ConnectionPool connectionPool)
    - {static} void addNewMaterial(Context ctx, ConnectionPool connectionPool)
}

class AccountMapper {
    + {static} Account login(String email, String password, ConnectionPool connectionPool)
    + {static} void createAccount(Account account, ConnectionPool connectionPool)
    + {static} Account getAccountById(int accountId, ConnectionPool connectionPool)
    - {static} Account getAccount(int accountId, String email, String password, ResultSet rs)
}

class OrderMapper {
    + {static} List<Order> getAllOrders(ConnectionPool connectionPool)
    + {static} List<Order> getAllOrdersByStatus(Order.OrderStatus status, ConnectionPool connectionPool)
    + {static} List<OrderBillItem> getOrderBillItems(int orderId, Connection connection)
    + {static} List<Order> getAllCustomerOrders(int customerId, ConnectionPool connectionPool)
    + {static} void createOrder(Order order, ConnectionPool connectionPool)
    + {static} void createOrderBill(int orderId, List<OrderBillItem> orderBillItems, ConnectionPool connectionPool)
    + {static} void setOrderStatus(int orderId, Order.OrderStatus status, ConnectionPool connectionPool)
    + {static} void setOrderPrice(int orderId, int price, ConnectionPool connectionPool)
    + {static} Order getOrderById(int orderId, ConnectionPool connectionPool)
    + {static} void createOrderInvoice(int orderId, Invoice invoice, ConnectionPool connectionPool)
    + {static} Invoice getOrderInvoice(int orderId, ConnectionPool connectionPool)
}

class MaterialMapper {
    + {static} Material getMaterial(String description, ConnectionPool connectionPool)
    + {static} List<Material> getAllMaterials(String description, ConnectionPool connectionPool)
    + {static} List<Material> getAllMaterials(ConnectionPool connectionPool)
    + {static} Material getMaterialById(int materialVariantId, ConnectionPool connectionPool)
    + {static} void createMaterial(Material material, ConnectionPool connectionPool)
    + {static} void createMaterialVariant(Material material, ConnectionPool connectionPool)
    + {static} void getAllMaterialsFromResultSet(List<Material> materialList, PreparedStatement ps)
    + {static} Material getMaterialFromResultSet(ResultSet rs)
}

class ConnectionPool {
    - ConnectionPool()
    + {static} ConnectionPool getInstance()
    + {static} ConnectionPool getInstance(String user, String password, String url, String db)
    + synchronized Connection getConnection()
    + synchronized void close()
    - {static} HikariDataSource createHikariConnectionPool(String user, String password, String url, String db)
}

class DatabaseException {
    + DatabaseException(String userMessage)
    + DatabaseException(String userMessage, String systemMessage)
}

interface Account {
    + int getId()
    + void setId(int id)
    + String getEmail()
    + String getPassword()
    + String getRole()
}

class Seller implements Account {
    - int sellerId
    - String email
    - String password
    - String role
    + Seller(int sellerId, String email, String password, String role)

    + int getId()
    + void setId()
    + String getEmail()
    + String getPassword()
    + String getRole()
    + boolean equals(Object o)
    + int hashCode()
    + String toString()
}

class Customer implements Account {
    - int customerId
    - String email
    - String password
    - String role
    - String firstName
    - String lastName
    - String address
    - int zip
    - String city
    - String phoneNumber

    + int getId()
    + void setId()
    + String getEmail()
    + String getPassword()
    + String getRole()
    + String getFirstName()
    + String getLastName()
    + String getAddress()
    + int getZip()
    + String getCity()
    + String getPhoneNumber()
    + boolean equals(Object o)
    + int hashCode()
    + String toString()
}

class CarportSchematicGenerator {
    + {static} generateSchematic(int width, int length)
}

class OrderBillGenerator {
    + {static} List<OrderBillItem> generateOrderBill(int width, int length)
}

class Order {
    - int orderId
    - int accountId
    - String title
    - int carportWidth;
    - int carportLength;
    - Order.Status status
    - Integer totalPrice
    - List<OrderBillItem> orderBill
    - LocalDateTime timestamp

    + Order(int orderId, int accountId, String title, int carportWidth, int carportLength, OrderStatus status, double totalPrice, List<OrderBillItem> orderBill, LocalDateTime timestamp)
    + Order(int accountId, String title, int carportWidth, int carportLength, OrderStatus status, double totalPrice, List<OrderBillItem> orderBill, LocalDateTime timestamp)

    + int getOrderId()
    + int getAccountId()
    + String getTitle()
    + int getCarportWidth()
    + int getCarportLength()
    + OrderStatus getStatus()
    + void setStatus(OrderStatus status)
    + Integer getTotalPrice()
    + void setTotalPrice(double newPrice)
    + List<OrderBillItem> getOrderBill()
    + LocalDateTime getTimestamp()
    + void setOrderId(int orderId)
    + boolean equals(Object o)
    + int hashCode()
    + String toString()
}

enum Order.Status {
    WAITING_FOR_REVIEW
    REVIEW_APPROVED
    PAID
}

class OrderBillItem {
    - Material material
    - String description
    - int quantity

    + OrderBillItem(Material material, String description, int quantity)
    + Material getMaterial()
    + String getDescription()
    + int getQuantity()
    + double getItemPrice()
    + boolean equals(Object o)
    + int hashCode()
    + String toString()
}

class Invoice {
    - int invoiceId
    - int orderId
    - int accountId
    - LocalDate date

    + int getInvoiceId()
    + int getOrderId()
    + int getAccountId()
    + LocalDate getLocalDate()
    + String toString()
}

class Material {
    - int materialId
    - int materialVariantId
    - String description
    - String unit
    - int price
    - Integer length
    - Material.Type

    + int getMaterialId()
    + getMaterialVariantId()
    + String getDescription()
    + String getUnit()
    + int getPrice()
    + Integer getLength()
    + Material.Type getType()
    + boolean equals(Object o)
    + int hashCode()
    + String toString()
}

enum Material.Type {
    WOOD
    SCREWS
}

Main *-- AccountController
Main *-- OrderController
Main *-- SalesController

AccountController *-- AccountMapper
OrderController *-- OrderMapper
SalesController *-- OrderMapper

OrderController *-- CarportSchematicGenerator
OrderController *-- OrderBillGenerator
OrderController *-- Customer
SalesController *-- CarportSchematicGenerator

AccountMapper *-- Account
OrderMapper *-- Order
OrderMapper *-- Invoice
OrderMapper *-- MaterialMapper
MaterialMapper *-- Material

Order *-- OrderBillItem
Order +-- Order.Status

Material +-- Material.Type

@enduml